<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management System</title>
    <link rel="stylesheet" href="./../assets/css/styles.css">
</head>
<body>
    <div class="sidebar">
        <div class="profile">
            
            <h2>Naida Sma</h2>
            <p>Admin</p>
        </div>
        <ul class="nav-links">
            <li><a href="main_page.html">Dashboard</a></li>
            <li><a href="inventory_management.html">Inventory Management</a></li>
            <li><a href="categories.html">Categories</a></li>
            <li><a href="suppliers.html">Suppliers</a></li>
            <li><a href="invoice.html">Invoice</a></li>
            <li><a href="settings.html">Settings</a></li>
            <li><a href="barcode.html">Barcode scanning</a></li>

        </ul>
    </div>
    <div class="container">
        <div class="supplier-container">
            <div class="form-container-supplier">
              <form id="supplierForm">
                <h2>Add New Supplier</h2>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="supplierName">Name</label>
                    <input type="text" id="supplierName" name="supplierName" autocomplete="off"  required>
                  </div>
          
                  <div class="form-group">
                    <label for="address">Address</label>
                    <input type="text" id="address" name="address" autocomplete="off" required>
                  </div>
                </div>
          
                <div class="form-row">
                  <div class="form-group">
                    <label for="contactNo">Contact Number</label>
                    <input type="text" id="contactNo" name="contactNo" autocomplete="off" required>
                  </div>
                </div>
          
                <div class="form-group">
                  <button type="submit" onclick="addSupplier()">Add Supplier</button>
                </div>
              </form>
            </div>
          
            <div class="list-container">
             
              <ul id="supplier-list">
                <!-- Supplier items will be listed here -->
              </ul>
            </div>
          </div>
          
</div>
<script src="../assets/js/jquery.js"></script>
<script src="../assets/js/jquery.min.js"></script>
<script>
    function getSuppliers() {
    $.ajax({
        url: '../../rest/suppliers',
        method: 'GET',
        success: function(data) {
            console.log("Data received from server:", data);  

            let output = '';
            data.forEach(supplier => {
                output += `
                    <li>
                        <div class="supplier-item">
                        <h3>${supplier.supplierName}</h3>
                        <p><strong>Address:</strong> ${supplier.address}</p>
                        <p><strong>Contact No:</strong> ${supplier.contactNo}</p>
                        <button class="delete-btn" onclick="deleteSupplier(${supplier.id})">Delete</button>
                    </div>
                    
                    </li>`;
            });
                

            const supplierList = document.getElementById("supplier-list");
            if (supplierList) {
                supplierList.innerHTML = output;
            } else {
                console.log("Element with id not found");
            }
        },
    });
}

    function addSupplier() {
        
    var supplier = {};
    supplier.supplierName = document.getElementById("supplierName").value;
    supplier.address = document.getElementById("address").value;
    supplier.contactNo = document.getElementById("contactNo").value;
    console.log("Sending supplier data:", supplier);
    $.ajax({
        url: '../../rest/suppliers/add',
        method: 'POST',
        data:supplier,
        dataType:"json",
        success: function(data) {
            console.log("success");
            getSuppliers(); 
            document.getElementById('supplierName').value = '';
            document.getElementById('address').value = '';
            document.getElementById('contactNo').value = '';

        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);
            alert("There was an error adding the supplier. Please try again later.");
        }
    });
}
getSuppliers();
function deleteSupplier (id) {
    $.ajax({
        url: '../../rest/suppliers/' + id,
        method: 'DELETE',
        success: function() {
            console.log("Supplier deleted successfully.");
            getSuppliers(); 
        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);
        }
    });
}
</script>
</body>
</html>